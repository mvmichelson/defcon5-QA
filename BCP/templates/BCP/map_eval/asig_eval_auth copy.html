<! Programa HTML>
<! Autorizacion de la asignacion de Escenarios de Riesgo al Proceso>
<!Programado por Marco A. Villalobos M>
<!==================================================================>

{% extends "base_generic.html" %}

{% block content %}


	{% block encabezado_auth_esc %}
	<ul class="encabezado_B">
        <p><aa><strong>FORMULARIO DE AUTORIZACION DE ANALISIS DE IMPACTO (BIA):</aa>
	</ul>
	<ul class='encabezado_SB'>
	<p><aa>{{proceso.path}} </strong></aa>
	</ul>
	{% endblock %}

<!==========================>
<!Informacion para Evaluacion>
<!==========================>

	
	{%block lista_eval%}
	<h5><strong>1.&emsp;INFORMACION PARA EVALUACION</strong></h5>
	

	<ul class="scr2">
		
		<h6><strong>1.1.&emsp;Identificacion del Proceso</strong></h6>
	  	<p>&emsp;&emsp;&emsp;<strong>Nombre........:</strong> {{ proceso.nombre }}</p>
	  	<p>&emsp;&emsp;&emsp;<strong>Objetivo......:</strong> {{ proceso.objetivo }}</p>
		<br/>

		<p><h6><strong>1.2. &emsp;Politica de asignacion de niveles de Impacto al negocio</strong></p>
				<p>El siguiente cuadro muestra los tipos de Impacto al negocio definidos y su clasificacion de acuerdo a su nivel de riesgo.</h6></p>
				<br/>
		<table class="lta">
		   <thead>
		   <tr>
			<th scope="col">TIPO</th>
			<th scope="col">DESCRIPCION</th>
			<th scope="col">NIVEL</th>
			<th scope="col">DESCRIPCION</th>
			
		   </tr>
		   </thead>

		   <tbody>
		   {%for imp in impactos.all  %}
			
		   <tr>
			{% if imp.nombre == 'Alto' %}
				<th scope="row"><bb>{{imp.tipo.nombre}}<bb></th>
				<th scope="row"><bb>{{imp.tipo.descripcion}}<bb></th>
			{%else%}
				<th scope="row"><bb><bb></th>
				<th scope="row"><bb><bb></th>
			{%endif%}

			<th scope="row"><bb>{{imp.nombre}}<bb></th>
			<th scope="row"><bb>{{imp.descripcion}}<bb></th>
		   </tr>

       		   	{% if not forloop.last %}
        	   	{%endif%}
      		   {%endfor%}

		   </tbody>
		</table>

		<br/>
		<p><h6><strong>1.3. &emsp;Politica de asignacion de Indicadores de Recuperacion</strong></p>
                               <p> El siguiente cuadro muestra los indicadores de recuperacion definidos y su clasificacion de acuerdo a su nivel de criticidad</h6></p>

		<table class="lta">
		   <thead>
		   <tr>
			<th scope="col">TIPO</th>
			<th scope="col">DESCRIPCION</th>
			<th scope="col">NIVEL</th>
			<th scope="col">DEFINICION</th>
		   </tr>
		   </thead>

		   <tbody>
		   {%for ind in indicadores.all  %}
			
		   <tr>
			{% if ind.nivel == 'ALTO' %}
				<th scope="row"><bb>{{ind.tipo.nombre}}<bb></th>
				<th scope="row"><bb>{{ind.tipo.descripcion}}<bb></th>
			{%else%}
				<th scope="row"><bb><bb></th>
				<th scope="row"><bb><bb></th>
			{%endif%}
			<th scope="row"><bb>{{ind.nivel}}<bb></th>
			<th scope="row"><bb>{{ind.definicion}}<bb></th>
		   </tr>
       		   {% if not forloop.last %}
        	   {%endif%}
      		   {%endfor%}

		   </tbody>
		</table>

		<br/>


	</ul>
	{%endblock%}

 
<!===============================================================================================>
	<h5><strong>2.&emsp;REVISION/OBSERVACION DE DATOS PROPUESTOS</strong></h5>
	
	<ul class="scr2">
	<p>Revisar los datos del Proceso y hacer observacion ( üìù ) en caso de requerir algun cambio o correccion.</p>
	
		{%block lista_impactoc%}
		<h5><strong>2.1.&emsp;Indicadores de Impacto:</strong></h5>
		</br>
		
		<table class="lta">
		   <thead class='encabezado_C'>
		   <tr>
			<th scope="col">TIPO</th>
			<th scope="col">ASIGNACION</th>
			<th scope="col">DESCRIPCION</th>
			<th scope="col">OBS.</th>
		   </tr>
		   </thead>

		   <tbody>

		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.impacto_1.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_1.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_1.descripcion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Impacto Financiero' proceso.pk  proceso.subproceso.impacto_1.nombre %}"><bb><strong>&#128221</bb></strong></a><bb></th>
			
		   </tr>

		
		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.impacto_2.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_2.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_2.descripcion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Impacto Reputacional' proceso.pk  proceso.subproceso.impacto_2.nombre %}"><bb><strong>&#128221</bb></strong></a><bb></th>
		   </tr>


		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.impacto_3.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_3.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_3.descripcion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Impacto Normativo' proceso.pk  proceso.subproceso.impacto_3.nombre %}"><bb><strong>&#128221</bb></strong></a><bb></th>
		  </tr>


		  <tr>			
			<th scope="row"><bb>{{proceso.subproceso.impacto_4.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_4.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.impacto_4.descripcion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Impacto Legal' proceso.pk  proceso.subproceso.impacto_4.nombre %}"><bb><strong>&#128221</bb></strong></a><bb></th>
			
		   </tr>
       		   
		   </tbody>
		</table>
	   	{%endblock%}

		{%block lista_indicador%}

		</br>
		
		<h5><strong>2.2.&emsp;Indicadores de Recuperacion:</strong></h5>
		(revisar Indicadores propuestos y aprobar o indicar observaciones)
		</br>
		
		<table class="lta">
		   <thead class='encabezado_C'>
		   <tr>
			<th scope="col">TIPO</th>
			<th scope="col">ASIGNACION</th>
			<th scope="col">DESCRIPCION</th>
			<th scope="col">OBS.</th>

		   </tr>
		   </thead>

		   <tbody>

		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.rto.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.rto.nivel}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.rto.definicion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Indicador.RTO' proceso.pk  proceso.subproceso.rto.nivel %}"><bb><strong>&#128221</bb></strong></a><bb></th>
			
		   </tr>
		   </br>
		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.rpo.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.rpo.nivel}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.rpo.definicion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Indicador.RPO' proceso.pk  proceso.subproceso.rpo.nivel %}"><bb><strong>&#128221</bb></strong></a><bb></th>
		   </tr>
		   <tr>
			<th scope="row"><bb>{{proceso.subproceso.mtd.tipo.nombre}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.mtd.nivel}}<bb></th>
			<th scope="row"><bb>{{proceso.subproceso.mtd.definicion}}<bb></th>
			<th scope="row"><bb> <a href = "{% url 'obs-proceso' 'Indicador.MTD' proceso.pk  proceso.subproceso.mtd.nivel %}"><bb><strong>&#128221</bb></strong></a><bb></th>
		  </tr>
		        		   
		   </tbody>
		</table>

		{%endblock%}

	</ul>

	{%block Conclusion%}
		<p><h5><strong>3.&emsp;CONCLUSION</strong></h5>

		<ul class="scr4">

		{%block A%}
		<h5><strong>3.1. &emsp;Observaciones realizadas</strong></p>
		{%if proceso.log_auth.all %}
		<p>Las observaciones seran remitidas al <strong>Gestor Consultor</strong>, quien procedera a implementarlas para volver a ser puestas a su
		disposicion para su autorizacion u observacion.</p></h5>
		<br/>
		
		<table class="lta">

    		<thead class='encabezado_D'>
      		<tr>
			<th scope="col">Fecha</th>
			<th scope="col">Item</th>
			<th scope="col">Observacion</th>
			<th scope="col">Gestor</th>
			<th scope="col">X</th>
			
      		</tr> 
    		</thead>
    		<tbody>
    
       		{%for log_auth in proceso.log_auth.all %}
			<tr>
      	  		<th scope="row"><bb>{{log_auth.fecha}}</bb></th>
			<th scope="row"><bb>{{log_auth.item}}</bb></th>
	  		<th scope="row"><bb>{{log_auth.observacion}}</bb></th>
			<th scope="row"><bb>{{log_auth.gestor_aprobador}}</bb></th>
			{%if request.user.username == log_auth.gestor_aprobador.user_gestor.username %}
				<th scope="row"> <a href = "{% url 'borra-obs-proceso'  log_auth.pk  %}"> <rr>&#128465</rr></a>
			{%else%}
				<th scope="row"> <aa>...</aa></a>
			{%endif%}
			</th>

		</tr>
        	{% if not forloop.last %}
        	{%endif%}
      		{%endfor%}
    		</tbody>		
		</table>
		{%else%}
		   <p>Sin Observaciones</p></p></h5>
		{%endif%}
		{% endblock %}
		
		<br/>
		<h5><strong>3.2. &emsp;Conclusion</strong></h5>
		{%block C%}
		<form action="" method="post">
        		{% csrf_token %}
        		
        		<p><strong>Indique <aa>(&#10004)</aa> &emsp;{{ form.aprobacion }}&emsp;si los niveles de criticidad asignados a los indicadores de Impacto y Recuperacion para el 
			Proceso {{proceso.nombre}} estan correctos y son autorizados.</strong>(En caso de haber observaciones especificas en 3.1  no autorizar)</p></p>
			<p><strong>Comentario general:</strong>&emsp;{{ form.comentario }}</p>
			<br/>
			<br/>
        		<input type="submit" value="Registrar" />
	    	</form>
		{%endblock%}
		</ul>
	{% endblock %}
	

{% endblock %}

